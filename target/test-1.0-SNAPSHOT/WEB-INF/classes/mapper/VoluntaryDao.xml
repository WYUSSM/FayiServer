<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace为对应的dao类路径 -->
<mapper namespace="com.sig.fayi.dao.VoluntaryDao">

    <resultMap type="com.sig.fayi.entity.Voluntary" id="VoluntaryResult">
        <id column="id" property="id"/>
        <result column="organizationId" property="organizationId"/>
        <result column="siginUpStartTime" property="siginUpStartTime"/>
        <result column="siginUpEndTime" property="siginUpEndTime"/>
        <result column="startTime" property="startTime"/>
        <result column="endTime" property="endTime"/>
        <result column="chargeName" property="chargeName"/>
        <result column="chargePhone" property="chargePhone"/>
        <result column="peopleNum" property="peopleNum"/>
        <result column="signUpNum" property="signUpNum"/>
        <result column="address" property="address"/>
        <result column="addressLongitude" property="addressLongitude"/>
        <result column="addressLatitude" property="addressLatitude"/>
        <result column="voluntaryMore" property="voluntaryMore"/>
        <result column="voluntaryCover" property="voluntaryCover"/>
        <result column="title" property="title"/>
        <result column="createTime" property="createTime"/>
        <association property="organization" javaType="com.sig.fayi.entity.Organization" column="organizationId" select="findOrganization"></association>
        <collection property="activityComments" resultMap="CommentResult"/>
        <collection property="activitySignUps" resultMap="SignUpResult"/>
    </resultMap>
    <resultMap type="com.sig.fayi.entity.ActivityComment" id="CommentResult">
        <id column="commentId" property="id"/>
        <result column="activityId" property="activityId"/>
        <result column="content" property="content"/>
        <result column="time" property="time"/>
        <result column="goodCount" property="goodCount"/>
        <result column="replyCount" property="replyCount"/>
        <association property="commentor" javaType="com.sig.fayi.entity.User" column="commentor" select="findUser">
        </association>
        <association property="commentor1" javaType="com.sig.fayi.entity.Organization" column="commentor1" select="findOrganization">
        </association>
        <collection property="activityGoodList" resultMap="GoodResult"/>
        <collection property="activityReplyList" resultMap="ReplyResult"/>
    </resultMap>
    <resultMap type="com.sig.fayi.entity.ActivitySignUp" id="SignUpResult">
        <id column="signupId" property="id"/>
        <result column="signupactivityId" property="activityId"/>
        <result column="signUpTime" property="signUpTime"/>
        <association property="user" javaType="com.sig.fayi.entity.User" column="userId" select="findUser">
        </association>
    </resultMap>
    <resultMap type="com.sig.fayi.entity.ActivityGood" id="GoodResult">
        <id column="goodId" property="goodId"/>
        <result column="commentId" property="commentId"/>
        <result column="gooder" property="gooder"/>
        <result column="gooder1" property="gooder1"/>
        <result column="good_time" property="good_time"/>
    </resultMap>
    <resultMap type="com.sig.fayi.entity.ActivityReply" id="ReplyResult">
        <id column="replyId" property="replyId"/>
        <result column="commentId" property="commentId"/>
        <result column="reply_conent" property="reply_conent"/>
        <result column="reply_time" property="reply_time"/>
        <association property="responder" javaType="com.sig.fayi.entity.User" column="responder" select="findUser">
        </association>
        <association property="responder1" javaType="com.sig.fayi.entity.Organization" column="responder1" select="findOrganization">
        </association>
    </resultMap>
    <select id="findGood" resultType="com.sig.fayi.entity.ActivityGood">
        SELECT * FROM activitygood_tab WHERE commentId=#{000};
    </select>
    <select id="findUser" resultType="com.sig.fayi.entity.User">
        SELECT * FROM user_tab WHERE id=#{000};
    </select>
    <select id="findOrganization" resultType="com.sig.fayi.entity.Organization">
        SELECT * FROM organization_tab WHERE id=#{000};
    </select>
    <select id="findAllVoluntary" resultType="com.sig.fayi.entity.Voluntary" resultMap="VoluntaryResult">
        SELECT voluntary_tab.*,activitysignup_tab.*,activitycomment_tab.*,activitygood_tab.*,activityreply_tab.*
        FROM voluntary_tab
        LEFT OUTER JOIN activitysignup_tab ON activitysignup_tab.signupactivityId=voluntary_tab.id
        LEFT OUTER JOIN activitycomment_tab ON activitycomment_tab.activityId=voluntary_tab.id
        LEFT OUTER JOIN activitygood_tab ON activitygood_tab.commentId=activitycomment_tab.commentId
        LEFT OUTER JOIN activityreply_tab ON activityreply_tab.commentId=activitycomment_tab.commentId
        ORDER BY createTime DESC;
    </select>


</mapper>